<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Updating test inputs with shinytesters • shinytesters</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Updating test inputs with shinytesters">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinytesters</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/shinytesters.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Updating test inputs with shinytesters</h1>
            
      

      <div class="d-none name"><code>shinytesters.Rmd</code></div>
    </div>

    
    
<p>The shinytesters package is a way to update input values whilst
running tests through <code><a href="https://rdrr.io/pkg/shiny/man/testServer.html" class="external-link">shiny::testServer</a></code>.</p>
<p>When using <code>testServer</code>, any “update” function in shiny
(or any shiny related package) does nothing to the inputs within the
<code>session</code> object, and therefore the tests litter in
expressions to manually update inputs using
<code>session$setInputs</code>. This can create a disconnect between
what is expected to happen in the server-side and what is actually
happening.</p>
<p>shinytesters enables this through the function
<code>create_test_update_fns</code>. This function takes existing
function definitions, and converts the body of the function to
communicate with the test session object rather than the unavailable UI.
By including what the ID and value arguments, it is enough to determine
what the input is going to be after calling the update function.</p>
<p>In addition, it also takes all of the other arguments that are passed
to the update function, and gives them an input value too, appending the
argument name to the ID for an easy extraction in the test
expression.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simple module where when a button is clicked, a select input is updated to </span></span>
<span><span class="co"># select "h" out of the letters and checkbox is selected</span></span>
<span><span class="va">server_module_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html" class="external-link">moduleServer</a></span><span class="op">(</span><span class="va">id</span>, <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">button</span>, <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/updateSelectInput.html" class="external-link">updateSelectInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="st">"options"</span>, choices <span class="op">=</span> <span class="va">letters</span>, selected <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/updateCheckboxInput.html" class="external-link">updateCheckboxInput</a></span><span class="op">(</span>inputId <span class="op">=</span> <span class="st">"check"</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"When the button is clicked, the options update"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://testthat.r-lib.org/reference/local_mocked_bindings.html" class="external-link">local_mocked_bindings</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="../reference/create_test_update_fns.html">create_test_update_fns</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"updateSelectInput"</span>, <span class="st">"updateCheckboxInput"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .package <span class="op">=</span> <span class="st">"shiny"</span> </span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/testServer.html" class="external-link">testServer</a></span><span class="op">(</span></span>
<span>    app <span class="op">=</span> <span class="va">server_module_fn</span>, </span>
<span>    expr <span class="op">=</span> <span class="op">{</span></span>
<span>      <span class="co"># Uninitialised modulehas NULL for inputs</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/expect_null.html" class="external-link">expect_null</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">options</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># After clicking button, options choices and selected option update </span></span>
<span>      <span class="va">session</span><span class="op">$</span><span class="fu">setInputs</span><span class="op">(</span>button <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_identical</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">options</span>, <span class="st">"h"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_identical</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">options.choices</span>, <span class="va">letters</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">check</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="package-level-helpers">Package Level Helpers<a class="anchor" aria-label="anchor" href="#package-level-helpers"></a>
</h2>
<p>At the package level, the function <code>use_shiny_testers</code> is
available as a blanket assignment of all update functions in the
specified package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simple module where when a button is clicked, a select input is updated to select "h" out of the letters</span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"When the button is clicked, the options update"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/use_shiny_testers.html">use_shiny_testers</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/testServer.html" class="external-link">testServer</a></span><span class="op">(</span></span>
<span>    app <span class="op">=</span> <span class="va">server_module_fn</span>, </span>
<span>    expr <span class="op">=</span> <span class="op">{</span></span>
<span>      <span class="co"># Uninitialised modulehas NULL for inputs</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/expect_null.html" class="external-link">expect_null</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">options</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># After clicking button, options choices and selected option update </span></span>
<span>      <span class="va">session</span><span class="op">$</span><span class="fu">setInputs</span><span class="op">(</span>button <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_identical</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">options</span>, <span class="st">"h"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_identical</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">options.choices</span>, <span class="va">letters</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">check</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ashley Baldry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
